generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model avaliacao {
  avaliacao_id   Int       @id @default(autoincrement())
  expositor_id   Int
  cliente_id     Int
  nota           Int
  descricao      String?
  data_avaliacao DateTime? @default(now()) @db.Timestamptz(6)
  cliente        cliente   @relation(fields: [cliente_id], references: [cliente_id], onDelete: NoAction, onUpdate: NoAction)
  expositor      expositor @relation(fields: [expositor_id], references: [expositor_id], onDelete: NoAction, onUpdate: NoAction)
}

model cliente {
  cliente_id Int         @id @default(autoincrement())
  nome       String      @db.VarChar(100)
  email      String?     @unique @db.VarChar(100)
  telefone   String?     @db.VarChar(20)
  senha      String      @db.VarChar(255)
  avaliacao  avaliacao[]
  pedido     pedido[]
}

model expositor {
  expositor_id    Int         @id @default(autoincrement())
  nome            String      @db.VarChar(100)
  turma_curso     String?     @db.VarChar(50)
  contato         String?     @db.VarChar(100)
  descricao_venda String?
  visita          Int?        @default(0)
  avaliacao       avaliacao[]
  pedido          pedido[]
  produto         produto[]
  servico         servico[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model item_pedido {
  item_pedido_id         Int      @id @default(autoincrement())
  pedido_id              Int
  produto_id             Int?
  servico_id             Int?
  nome_item              String   @db.VarChar(100)
  quantidade             Int
  preco_unitario_vendido Decimal  @db.Decimal(10, 2)
  pedido                 pedido   @relation(fields: [pedido_id], references: [pedido_id], onDelete: NoAction, onUpdate: NoAction)
  produto                produto? @relation(fields: [produto_id], references: [produto_id], onDelete: NoAction, onUpdate: NoAction)
  servico                servico? @relation(fields: [servico_id], references: [servico_id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model pedido {
  pedido_id    Int           @id @default(autoincrement())
  expositor_id Int
  cliente_id   Int?
  data_hora    DateTime?     @default(now()) @db.Timestamptz(6)
  status       String        @default("novo") @db.VarChar(50)
  valor_total  Decimal       @db.Decimal(10, 2)
  item_pedido  item_pedido[]
  cliente      cliente?      @relation(fields: [cliente_id], references: [cliente_id], onDelete: NoAction, onUpdate: NoAction)
  expositor    expositor     @relation(fields: [expositor_id], references: [expositor_id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model produto {
  produto_id   Int           @id @default(autoincrement())
  expositor_id Int
  nome         String        @db.VarChar(100)
  descricao    String?
  preco        Decimal       @db.Decimal(10, 2)
  estoque      Int
  item_pedido  item_pedido[]
  expositor    expositor     @relation(fields: [expositor_id], references: [expositor_id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model servico {
  servico_id   Int           @id @default(autoincrement())
  expositor_id Int
  nome         String        @db.VarChar(100)
  descricao    String?
  preco        Decimal       @db.Decimal(10, 2)
  disponivel   Boolean       @default(true)
  item_pedido  item_pedido[]
  expositor    expositor     @relation(fields: [expositor_id], references: [expositor_id], onDelete: NoAction, onUpdate: NoAction)
}
